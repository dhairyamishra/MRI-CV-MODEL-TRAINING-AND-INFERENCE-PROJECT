# Configuration for Brain Tumor Classification Training
# SliceWise - Phase 2: Classification MVP

# Model configuration
model:
  name: "efficientnet"  # Options: 'efficientnet', 'convnext'
  pretrained: true
  num_classes: 2
  dropout: 0.3
  freeze_backbone: false

# Data configuration
data:
  data_dir: "data/processed/kaggle"
  train_dir: "data/processed/kaggle/train"
  val_dir: "data/processed/kaggle/val"
  test_dir: "data/processed/kaggle/test"
  batch_size: 32
  num_workers: 0
  pin_memory: true
  
  # Augmentation settings
  augmentation:
    use_augmentation: true
    augmentation_strength: "standard"  # Options: 'light', 'standard', 'strong'

# Training configuration
training:
  epochs: 50
  early_stopping_patience: 10
  
  # Optimizer
  optimizer:
    name: "adamw"  # Options: 'adam', 'adamw', 'sgd'
    lr: 0.0001
    weight_decay: 0.01
    betas: [0.9, 0.999]
  
  # Learning rate scheduler
  scheduler:
    use_scheduler: true
    name: "cosine"  # Options: 'cosine', 'step', 'plateau'
    # For cosine annealing
    T_max: 50
    eta_min: 0.000001
    # For step scheduler
    step_size: 10
    gamma: 0.1
    # For plateau scheduler
    patience: 5
    factor: 0.5
  
  # Loss function
  loss:
    name: "cross_entropy"  # Options: 'cross_entropy', 'focal'
    # For focal loss
    alpha: 0.25
    gamma: 2.0
    
  # Class weights (for imbalanced dataset)
  use_class_weights: true
  
  # Mixed precision training
  use_amp: true
  
  # Gradient clipping
  grad_clip: 1.0

# Validation configuration
validation:
  val_frequency: 1  # Validate every N epochs
  save_best_only: true
  metric: "roc_auc"  # Options: 'roc_auc', 'accuracy', 'loss'

# Checkpointing
checkpoint:
  save_dir: "checkpoints/cls"
  save_frequency: 5  # Save checkpoint every N epochs
  keep_last_n: 3  # Keep only last N checkpoints

# Logging configuration
logging:
  use_wandb: true
  wandb_project: "slicewise-classification"
  wandb_entity: null  # Set to your W&B username/team
  log_frequency: 10  # Log every N batches
  log_images: true
  num_images_to_log: 8

# Evaluation configuration
evaluation:
  compute_metrics: true
  save_predictions: true
  save_confusion_matrix: true
  save_roc_curve: true
  save_pr_curve: true
  threshold: 0.5  # Classification threshold

# Grad-CAM configuration
gradcam:
  generate_gradcam: true
  num_samples: 16
  save_dir: "assets/grad_cam_examples"

# Hardware configuration
hardware:
  device: "cuda"  # Options: 'cuda', 'cpu', 'auto'
  gpu_id: 0
  deterministic: true
  benchmark: true

# Reproducibility
seed: 42

# Paths
paths:
  output_dir: "outputs/classification"
  log_dir: "logs/classification"
  results_dir: "results/classification"
